# Vegan Restaurants
A web application to find restaurants that serve vegan food
### Required dependencies
**Server side:**
- express
- express-session
- cookie-session
- express-validator -- server side validation
- mysql -- database connection
- passport -- authenticating user
- passport-google-oauth2  -- for google login
- socket.io -- communication between client and server
- dotenv -- for google client id etc. sample text file example-env.txt
- nodemon -- making developers' lives easier

**Client side:**
- mapbox-gl -- showing restaurant's location
- mapbox-gl GeoCoder -- showing user's location
- rater.js -- for star ratings

### API examples:

| TYPE| EXPLANATION| EXAMPLE|
| ------ | ------ |------ |
| GET| get all the restaurants from database | /api/restaurant/all |
| GET| get the restaurant with corresponding id | /api/restaurant/**_restaurantID_** |
| PUT |update restaurant with corresponding id | /api/restaurant/**_restaurantID_** |
| DELETE|delete restaurant with corresponding id| /api/restaurant/**_restaurantID_**/token=**_token_** |
| POST|add restaurant| /addRestaurant/token=**_token_** |
| GET| search restaurants with given parameters| /api/restaurants/search/**_City_**/**_Helsinki_** |
| GET| get a single restaurant's reviews|/api/reviews/restaurant_id=1|
| GET| search reviews with given parameters| /api/reviews/search/**_Username_**/**_Matti_**
| GET| get all reviews|/api/reviews/all/token=**_token_**|
| PUT| update review with corresponding id|/api/reviews/1|
| DELETE| update review with corresponding id|/api/reviews/1|
| POST| add review |/addReview|


/api/restaurants/search/:searchBy/:parameter valid _searchBy_ values are: 
**restaurant_name**, **restaurant_address**, **zipcode**, **city**, **restaurant_desc**, **link**, **rating** and all from **monday to sunday**

/api/reviews/:searchBy/:parameter valid _searchBy_ values are: 
**stars**, **review** and **username**

Add restaurant and update restaurant body example: 
```json
body {
    "id": null,                              
    "restaurant_name": "Idan Ravintola",
    "restaurant_address": "Hämeentie 48",
    "zipcode": "00500",
    "city": "Helsinki",
    "link": "https://ravintolaida.fi",
    "restaurant_desc": "Itse tekemää herkkua!",
    "rating": null,                         
    "monday": "1100-2000",                  
    "tuesday": "1100-2000",                     
    "wednesday":"1000-2000",
    "thursday":"1100-2000",
    "friday": "1100-2000",
    "saturday": "1100-2000",
    "sunday": "1100-2000"
} 
``` 
- id is autogenerated
- when updating a restaurant rating and id are not updated
- opening hours are like that to make calculating easier

Add review and update review body example:
```json
{   
    "id": null,
    "restaurant_id": 1,
    "stars": 5,
    "review": "good",
    "userName": "Matti"
} 
```
### Login and authentication
**Login** is done with Google and after login you are given an **access token**. Token can be found on home page after clicking on a button with user's initials on it. Only one token is created per google user.
**Authentication used with:** 
- POST /addRestaurant/token=
- DELETE /api/restaurant/**_id_**/token=
- GET /api/reviews/all/token=

### API Validation
**DONE**
- add restaurant/update restaurant input body validation
- input id validation
- add review/update review input body validation
- search by values

## TODO
- validation for all api calls
- authentication for all api calls
- cleaning code - separate file for mysql 
